<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="orders">

	<!-- 리스트 페이징O/검색O -->
	<select id="paymentManageList" parameterType="map" resultType="OrdersVo">
		<![CDATA[
			select *
			from orders
		]]>
		<choose>
			<when test="keyword != null and category != null and category == 0">
				<![CDATA[
					where (o_name like concat('%', #{keyword}, '%') 
							or o_hp like concat('%', #{keyword}, '%') 
							or o_address like concat('%', #{keyword}, '%')
							or o_date like concat('%', #{keyword}, '%'))
				]]>
			</when>
				
			<when test="keyword != null and category != null and category == 1">
				<![CDATA[
					where (o_name like concat('%', #{keyword}, '%'))
				]]>
			</when>	
			<when test="keyword != null and category != null and category == 2">
				<![CDATA[
					where (o_hp like concat('%', #{keyword}, '%'))
				]]>
			</when>
			
			<otherwise></otherwise>
		</choose>
		<![CDATA[		
				order by o_no desc		 
				limit #{startRowNo}, #{listCnt}
			]]>
	</select>
	
	
	<select id="selectOrdersTotalCnt" parameterType="map" resultType="int">
		<![CDATA[
			select count(*) count
			from orders
		]]>
		<choose>
			<when test="keyword != null and category != null and category == 0">
				<![CDATA[
					where (o_name like concat('%', #{keyword}, '%') 
							or o_hp like concat('%', #{keyword}, '%') 
							or o_address like concat('%', #{keyword}, '%')
							or o_date like concat('%', #{keyword}, '%'))
				]]>
			</when>
			<when test="keyword != null and category != null and category == 1">
				<![CDATA[
					where (o_name like concat('%', #{keyword}, '%'))
				]]>
			</when>	
			<when test="keyword != null and category != null and category == 2">
				<![CDATA[
					where (o_hp like concat('%', #{keyword}, '%'))
				]]>
			</when>
			
			<otherwise></otherwise>
		</choose>
	</select>
	
	
	<!-- 배송상태 변경 -->
	<update id="pStatusChange" parameterType="int">
		<![CDATA[
		update orders
		set o_status = o_status + 1
		where o_no = #{o_no}
		]]>
	</update>
	
	
	
	
	
</mapper>